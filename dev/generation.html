<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Signal Generation · RP DAQ Server</title><meta name="title" content="Signal Generation · RP DAQ Server"/><meta property="og:title" content="Signal Generation · RP DAQ Server"/><meta property="twitter:title" content="Signal Generation · RP DAQ Server"/><meta name="description" content="Documentation for RP DAQ Server."/><meta property="og:description" content="Documentation for RP DAQ Server."/><meta property="twitter:description" content="Documentation for RP DAQ Server."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="RP DAQ Server logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">RP DAQ Server</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="architecture.html">Architecture</a></li><li><a class="tocitem" href="installation.html">Installation</a></li><li><a class="tocitem" href="cluster.html">Cluster</a></li><li><a class="tocitem" href="connections.html">Connections</a></li><li><a class="tocitem" href="acquisition.html">Data Acquisition</a></li><li class="is-active"><a class="tocitem" href="generation.html">Signal Generation</a><ul class="internal"><li><a class="tocitem" href="#Waveforms"><span>Waveforms</span></a></li><li><a class="tocitem" href="#Ramping"><span>Ramping</span></a></li><li><a class="tocitem" href="#Sequences"><span>Sequences</span></a></li><li><a class="tocitem" href="#Calibration"><span>Calibration</span></a></li></ul></li><li><a class="tocitem" href="scpi.html">SCPI Interface</a></li><li><a class="tocitem" href="client.html">Client Library</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/simple.html">Simple</a></li><li><a class="tocitem" href="examples/waveforms.html">Waveforms</a></li><li><a class="tocitem" href="examples/ramping.html">Ramping</a></li><li><a class="tocitem" href="examples/sequence.html">Sequence</a></li><li><a class="tocitem" href="examples/sequenceMultiChannel.html">Sequence Multi-Channel and Waveform Enable</a></li><li><a class="tocitem" href="examples/seqRamping.html">Sequence Ramping</a></li><li><a class="tocitem" href="examples/cluster.html">Cluster</a></li><li><a class="tocitem" href="examples/batch.html">Batch</a></li><li><a class="tocitem" href="examples/producerConsumer.html">Continous Signal Acquisition</a></li></ul></li><li><a class="tocitem" href="fpga.html">FPGA Development</a></li><li><a class="tocitem" href="devtips.html">Development Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="generation.html">Signal Generation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="generation.html">Signal Generation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tknopp/RedPitayaDAQServer" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tknopp/RedPitayaDAQServer/blob/master/docs/src/generation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Signal-Generation"><a class="docs-heading-anchor" href="#Signal-Generation">Signal Generation</a><a id="Signal-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Signal-Generation" title="Permalink"></a></h1><p>Once the acquisition is triggered, each RedPitaya also starts producing signals on their output channels. Each RedPitaya features six such channels, two of those are the 16-bit DAC channel and four of those are digital pins using PDM, see <a href="connections.html">Connections</a>. The output signals are composed of three parts: parameterized waveforms <span>$W_i(t)$</span>, an offset <span>$o_i$</span> and repeating arbitrary LUT tables. The latter are called sequences <span>$seq_i(t)$</span>. The resulting signal of the DAC channel can be described as: </p><p class="math-container">\[S_i(t) = seq_i(t) + o_i + W_i(t)\]</p><h2 id="Waveforms"><a class="docs-heading-anchor" href="#Waveforms">Waveforms</a><a id="Waveforms-1"></a><a class="docs-heading-anchor-permalink" href="#Waveforms" title="Permalink"></a></h2><p>Each of the 16-bit DAC channel can output a compositve waveform with four components. Each component can be parametrized by its amplitude <span>$a_{i,j}$</span>, frequency <span>$f_{i,j}$</span> and phase <span>$\varphi_{i,j}$</span>, which can all be changed via SCPI commands. Furthermore, each component also offers different waveforms <span>$w_{i,j}$</span>(sine, triangle, sawtooth):</p><p class="math-container">\[W_i(t) = \sum_{j=1}^{4}a_{i,j} w_{i,j}(2\pi f_{i,j}t + \varphi_{i, j})\]</p><h2 id="Ramping"><a class="docs-heading-anchor" href="#Ramping">Ramping</a><a id="Ramping-1"></a><a class="docs-heading-anchor-permalink" href="#Ramping" title="Permalink"></a></h2><p>The signals output on the DAC channel can also be multiplied with an increasing/decreasing ramping factor <span>$r(t)$</span>. Ramping and the ramping duration can be enabled and set on a per channel basis. The increasing factor starts from 0 and goes to 1 from the acquisition start on. The decreasing factor goes from 1 to 0.</p><p class="math-container">\[S_i&#39;(t) = r(t)S(t)\]</p><p>The ramp down has to be started either by a SCPI command or by a flag from a sequence. Disabling the acquisition trigger removes the ramp down flag, but not the flag that enables ramping itself.</p><h2 id="Sequences"><a class="docs-heading-anchor" href="#Sequences">Sequences</a><a id="Sequences-1"></a><a class="docs-heading-anchor-permalink" href="#Sequences" title="Permalink"></a></h2><p>The FPGA image features a LUT containing values for all output channels. This LUT is treated as a ring-buffer through which the image iterates and outputs the values on their respective channel. The image can be configured to increment its LUT access every n samples. One period of a value is also called a step. A sequence is a series of steps and the number of times this series is to be repeated.</p><p>As the LUT used by the FPGA image is small in comparison with the main memory and in order to support longer series of steps, the server itselfs maintains a sequence in its main memory and periodically reads the next steps from its sequence and writes them to the LUT of the image.</p><p>Comparable to the sample transmission of the acquisition, this updating of the LUT is also a process with timing uncertainty as it is affected by the scheduling and execution of the RedPitayas CPU. While during the sample transmission samples could be lost because they were overwritten, in the signal generation wrong signals could be output because the server was too slow in updating the values. Here, the server tracks similar performance metrics and also features a status flag <code>lostSteps</code> for exactly this case. In its current implementation a safe step rate is at 12 kHz.</p><p>Sequences and their steps also have additional features. A step can be marked such that during its duration the signal is set to 0. Furthermore, a step can be marked such that it triggers the ramp down. To make this easier to manage the server actually manages three sequences, that can be set individually: A ramp up, regular and ramp down sequence. The ramp up sequence is moved to the FPGA LUT at the acquisition start, followed by the regular sequence. Afterwards the ramp down sequence is started and during its execution the ramp down flag is set.</p><h2 id="Calibration"><a class="docs-heading-anchor" href="#Calibration">Calibration</a><a id="Calibration-1"></a><a class="docs-heading-anchor-permalink" href="#Calibration" title="Permalink"></a></h2><p>Similar to the signal acquisition, there are also calibration scale <span>$c_{i, scale}$</span> and offset <span>$c_{i, offset}$</span> values  for the signal generation. These are stored in the EEPROM of the RedPitaya and can be updated by a client. The calibration values are always applied, even when the master trigger is off.</p><p>Thus the total signal can be described as:</p><p class="math-container">\[S_i&#39;&#39;(t) = c_{i, scale} S_i&#39;(t) + c_{i, offset}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="acquisition.html">« Data Acquisition</a><a class="docs-footer-nextpage" href="scpi.html">SCPI Interface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 27 September 2024 13:07">Friday 27 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
