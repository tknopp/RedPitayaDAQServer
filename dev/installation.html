<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Installation · RP DAQ Server</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="RP DAQ Server logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">RP DAQ Server</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="architecture.html">Architecture</a></li><li class="is-active"><a class="tocitem" href="installation.html">Installation</a><ul class="internal"><li><a class="tocitem" href="#Julia-Client"><span>Julia Client</span></a></li><li class="toplevel"><a class="tocitem" href="#Updating"><span>Updating</span></a></li><li class="toplevel"><a class="tocitem" href="#Security-Considerations"><span>Security Considerations</span></a></li><li class="toplevel"><a class="tocitem" href="#Building-Components"><span>Building Components</span></a></li><li><a class="tocitem" href="#Linux-Image-and-FPGA-Images"><span>Linux Image and FPGA Images</span></a></li><li><a class="tocitem" href="#Server"><span>Server</span></a></li><li><a class="tocitem" href="#Julia-Client-Library"><span>Julia Client Library</span></a></li></ul></li><li><a class="tocitem" href="connections.html">Connections</a></li><li><a class="tocitem" href="cluster.html">Cluster</a></li><li><a class="tocitem" href="acquisition.html">Data Acquisition</a></li><li><a class="tocitem" href="generation.html">Signal Generation</a></li><li><a class="tocitem" href="scpi.html">SCPI Interface</a></li><li><a class="tocitem" href="client.html">Client Library</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/simple.html">Simple</a></li><li><a class="tocitem" href="examples/waveforms.html">Waveforms</a></li><li><a class="tocitem" href="examples/ramping.html">Ramping</a></li><li><a class="tocitem" href="examples/sequence.html">Sequence</a></li><li><a class="tocitem" href="examples/sequenceMultiChannel.html">Sequence Multi-Channel and Waveform Enable</a></li><li><a class="tocitem" href="examples/seqRamping.html">Sequence Ramping</a></li><li><a class="tocitem" href="examples/cluster.html">Cluster</a></li><li><a class="tocitem" href="examples/batch.html">Batch</a></li><li><a class="tocitem" href="examples/producerConsumer.html">Continous Signal Acquisition</a></li></ul></li><li><a class="tocitem" href="fpga.html">FPGA Development</a></li><li><a class="tocitem" href="devtips.html">Development Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="installation.html">Installation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="installation.html">Installation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tknopp/RedPitayaDAQServer/blob/master/docs/src/installation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h1><p>The RedPitayaDAQServer project uses a custom RedPitaya image that was derived from the <a href="https://github.com/pavel-demin/red-pitaya-notes">red-pitaya-notes</a> project. It consists of an Alpine Linux with some development tools installed, as well as the server and the FPGA images. The Linux image reserves the upper 128 MB of main memory for the FPGA, which is used as a buffer for recording the data from the ADCs. The latest releases of the project can be downloaded <a href="https://github.com/tknopp/RedPitayaDAQServer/releases">here</a>.</p><p>To install the project on a RedPitaya, format an SD card in FAT32 and enable the bootable flag. On Linux this can be done with:</p><pre><code class="nohighlight hljs">sudo fdisk /dev/sdb</code></pre><p>on the correct device. In the prompt create a new partition with <code>n</code> and change its type to FAT32 with the <code>t</code> command and the hex code <code>b</code>. With the command <code>a</code> the bootable flag can be toggled. Finish formatting with the <code>w</code> command.</p><p>Afterwards a file system can be created with:</p><pre><code class="nohighlight hljs">sudo mkfs -t vfat /dev/sdb1</code></pre><p>To finish installing the RedPitaya, simply unzip one of the releases and copy the files into the now empty and formatted SD card.</p><p>When the RedPitaya is now booted, the server should start. One can then use a client to connect, at which point the FPGA image is loaded. </p><p>The client library provided with the project is not an executable program, but it can be used to implement one. The library encapsulates the communication with the server and implements various optimizations. As the communication with the server is language agnostic one could therefore implement their own client in a different language. The Julia reference client library found in <code>src/client/julia</code>, the <a href="scpi.html">SCPI commands</a> and the sections on the signal <a href="acqusition.md">acquisition</a> and <a href="generation.html">generation</a> are starting points for such a custom client.</p><h2 id="Julia-Client"><a class="docs-heading-anchor" href="#Julia-Client">Julia Client</a><a id="Julia-Client-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-Client" title="Permalink"></a></h2><p>To use the provided Julia client library you need to install RedPitayaDAQServer Julia package within Julia. To this end  download Julia 1.5 or later and go into the package manager mode by intering <code>]</code>. Then with </p><pre><code class="nohighlight hljs">add RedPitayaDAQServer</code></pre><p>the latest release of the Julia client is added. To install a different version, please consult the <a href="https://pkgdocs.julialang.org/dev/managing-packages/#Adding-packages">Pkg documentation</a>. The Julia client and the RedPitaya image should be from the same release to avoid errors due to communication protocol changes.</p><h1 id="Updating"><a class="docs-heading-anchor" href="#Updating">Updating</a><a id="Updating-1"></a><a class="docs-heading-anchor-permalink" href="#Updating" title="Permalink"></a></h1><p>The Julia client offers function to automatically update the server and FPGA of a RedPitaya. More on this can be found <a href="client.html#utility">here</a>. Note that this process deletes all data in the <code>RedPitayaDAQServer</code> folder on the RedPitaya.</p><h1 id="Security-Considerations"><a class="docs-heading-anchor" href="#Security-Considerations">Security Considerations</a><a id="Security-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Security-Considerations" title="Permalink"></a></h1><p>The system as it is provided here should not be accessible from the internet as it uses an default public password and publically known ssh-key.</p><h1 id="Building-Components"><a class="docs-heading-anchor" href="#Building-Components">Building Components</a><a id="Building-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Building-Components" title="Permalink"></a></h1><h2 id="Linux-Image-and-FPGA-Images"><a class="docs-heading-anchor" href="#Linux-Image-and-FPGA-Images">Linux Image and FPGA Images</a><a id="Linux-Image-and-FPGA-Images-1"></a><a class="docs-heading-anchor-permalink" href="#Linux-Image-and-FPGA-Images" title="Permalink"></a></h2><p>If you want to build the Linux image or the FPGA bitfiles yourself, you can install Xilinx Vitis and Vivado (2021.2) in an Ubuntu environment (bare metal or virtual machine). Then run</p><pre><code class="nohighlight hljs">sudo apt-get update

sudo apt-get --no-install-recommends install \
  build-essential bison flex git curl ca-certificates sudo \
  xvfb fontconfig libxrender1 libxtst6 libxi6 make \
  bc u-boot-tools device-tree-compiler libncurses5-dev \
  libssl-dev qemu-user-static binfmt-support zip \
  squashfs-tools dosfstools parted debootstrap zerofree</code></pre><p>in order to get the essential tools. Afterwards clone the project with</p><pre><code class="nohighlight hljs">git clone https://github.com/tknopp/RedPitayaDAQServer</code></pre><p>Then switch into this directory. You can build the whole project using</p><pre><code class="nohighlight hljs">make all</code></pre><p>For only building some parts, such as the FPGA image, please refer to the Makefile.</p><p>Note: <code>make</code> has to be run as root if you want to build the Linux image, since <code>chroot</code> requires <code>root</code> privileges.</p><h2 id="Server"><a class="docs-heading-anchor" href="#Server">Server</a><a id="Server-1"></a><a class="docs-heading-anchor-permalink" href="#Server" title="Permalink"></a></h2><p>To build the RedPitaya server connect the RedPitaya to you local network and accessto you local network and access the device via ssh:</p><pre><code class="nohighlight hljs">ssh root@rp-f?????.local</code></pre><p>where ????? is the ID that is printed on the RedPitaya. The default password is <code>root</code>. After logging into the RedPitaya go to the folder</p><pre><code class="nohighlight hljs">/root/apps/</code></pre><p>and clone the RedPitayaDAQServer project if it does not exist already:</p><pre><code class="nohighlight hljs">git clone https://github.com/tknopp/RedPitayaDAQServer</code></pre><p>Sometimes you might need to make the file system writable by entering</p><pre><code class="nohighlight hljs">mount -o remount,rw /dev/mmcblk0p1</code></pre><p>Then cd into RedPitayaDAQServer</p><pre><code class="nohighlight hljs">cd /root/apps/RedPitayaDAQServer</code></pre><p>and enter <code>make server</code>. This will compile the library, the server, and some example applications. After you restart the RedPitaya the DAQ server will automatically run and you can access it via TCP.</p><p>Under <code>src/scripts/rp-internet.sh</code> an example script can be found, that shows how to let the RedPitaya access the internet through a client computer.</p><h2 id="Julia-Client-Library"><a class="docs-heading-anchor" href="#Julia-Client-Library">Julia Client Library</a><a id="Julia-Client-Library-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-Client-Library" title="Permalink"></a></h2><p>Another option when installing the Julia client is to <code>dev</code> the package with</p><pre><code class="nohighlight hljs">dev RedPitayaDAQServer</code></pre><p>in the package mode <code>]</code>.</p><p>This installs the package in development mode and puts the files into <code>~/.julia/dev/RedPitayaDAQServer/</code>. There you can the also modify the files, which is handy when trying out the examples. You need to manually <code>git pull</code> if you want to get updates, i.e. Julia will not update developed packages automatically.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="architecture.html">« Architecture</a><a class="docs-footer-nextpage" href="connections.html">Connections »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Monday 4 July 2022 16:17">Monday 4 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
